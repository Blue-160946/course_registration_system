{% extends 'core/base.html' %}

{% block title %}ตารางเรียนของฉัน{% endblock %}

{% block content %}
  <div class="p-4 mb-4 bg-orange-gradient text-white rounded-3">
    <div class="container-fluid py-3">
      <h1 class="display-5 fw-bold">ตารางเรียนของฉัน</h1>
      <p class="col-md-8 fs-5">
        {% if current_semester %}
          สำหรับ {{ current_semester }}
        {% else %}
          ยังไม่มีภาคเรียนปัจจุบัน
        {% endif %}
      </p>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>รหัสวิชา</th>
          <th>ชื่อวิชา</th>
          <th>กลุ่ม</th>
          <th>วัน-เวลา</th>
          <th>ห้อง</th>
          <th>ผู้สอน</th>
        </tr>
      </thead>
      <tbody>
        {% for section in enrolled_sections %}
          <tr>
            <td>{{ section.course.code }}</td>
            <td>{{ section.course.name }}</td>
            <td>{{ section.section_number }}</td>
            <td>
              {% for class_time in section.class_times.all %}
                <span class="badge me-2" style="background-color: #ffefe0; color: #fd7e14; border: 1px solid #fd7e14;">
                  {{ class_time.get_day_display }}
                </span>
                  {{ class_time.start_time|time:"H:i" }} - {{ class_time.end_time|time:"H:i" }}
                    {% if not forloop.last %}<br>{% endif %}
                    {% empty %}
                      - ไม่มีตารางเวลา
              {% endfor %}
            </td>
            <td>{{ section.room|default:"-" }}</td>
            <td>{% for inst in section.instructors.all %}{{ inst.profile.academic_title }} {{ inst.profile.first_name_th }} {{ inst.profile.last_name_th }}{% if not forloop.last %}<br>{% endif %}{% endfor %}</td>
          </tr>
        {% empty %}
          <tr><td colspan="6" class="text-center">คุณยังไม่ได้ลงทะเบียนเรียนในภาคเรียนนี้</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}

{% block extra_js %}
<style>
    .bg-orange-gradient {
        background: linear-gradient(135deg, #fd7e14, #ff9500);
    }
</style>
{% endblock %}